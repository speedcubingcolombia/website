---
const allEvents = [
  {
    name: "Bogotá Open 2025",
    date: "2025-01-15",
    city: "Bogotá",
    location: "Bogotá, Colombia",
    venue: "Universidad Nacional de Colombia",
    events: ["3x3x3", "2x2x2", "4x4x4", "5x5x5", "3x3x3 OH", "Pyraminx"],
    registrationDeadline: "2025-01-10",
    maxCompetitors: 150,
    wcaDelegate: "Carlos Andrés Rodríguez",
    status: "registration-open",
  },
  {
    name: "Medellín Speed Championship 2025",
    date: "2025-02-08",
    city: "Medellín",
    location: "Medellín, Colombia",
    venue: "Centro de Convenciones Plaza Mayor",
    events: ["3x3x3", "2x2x2", "4x4x4", "3x3x3 BLD", "Skewb", "Clock"],
    registrationDeadline: "2025-02-03",
    maxCompetitors: 120,
    wcaDelegate: "María Elena Vargas",
    status: "registration-open",
  },
  {
    name: "Cali Cube Fest 2025",
    date: "2025-03-22",
    city: "Cali",
    location: "Cali, Colombia",
    venue: "Universidad ICESI",
    events: ["3x3x3", "2x2x2", "4x4x4", "5x5x5", "6x6x6", "7x7x7", "Megaminx"],
    registrationDeadline: "2025-03-17",
    maxCompetitors: 100,
    wcaDelegate: "Andrés Felipe García",
    status: "coming-soon",
  },
  {
    name: "Cartagena Beach Cubing 2025",
    date: "2025-04-12",
    city: "Cartagena",
    location: "Cartagena, Colombia",
    venue: "Centro de Convenciones Cartagena de Indias",
    events: ["3x3x3", "2x2x2", "Pyraminx", "Skewb"],
    registrationDeadline: "2025-04-07",
    maxCompetitors: 80,
    wcaDelegate: "Isabella Martínez",
    status: "coming-soon",
  },
  {
    name: "Bucaramanga Open 2025",
    date: "2025-05-10",
    city: "Bucaramanga",
    location: "Bucaramanga, Colombia",
    venue: "Universidad Industrial de Santander",
    events: ["3x3x3", "2x2x2", "4x4x4", "3x3x3 OH", "Clock"],
    registrationDeadline: "2025-05-05",
    maxCompetitors: 90,
    wcaDelegate: "Diego Ramírez",
    status: "coming-soon",
  },
  {
    name: "Barranquilla Speed Day 2025",
    date: "2025-06-14",
    city: "Barranquilla",
    location: "Barranquilla, Colombia",
    venue: "Universidad del Norte",
    events: ["3x3x3", "2x2x2", "4x4x4", "Pyraminx"],
    registrationDeadline: "2025-06-09",
    maxCompetitors: 75,
    wcaDelegate: "Ana Sofía López",
    status: "coming-soon",
  },
  {
    name: "Bogotá Championship 2025",
    date: "2025-07-20",
    city: "Bogotá",
    location: "Bogotá, Colombia",
    venue: "Centro de Convenciones Gonzalo Jiménez de Quesada",
    events: [
      "3x3x3",
      "2x2x2",
      "4x4x4",
      "5x5x5",
      "6x6x6",
      "7x7x7",
      "3x3x3 BLD",
      "3x3x3 OH",
      "Megaminx",
      "Pyraminx",
      "Skewb",
      "Square-1",
      "Clock",
    ],
    registrationDeadline: "2025-07-15",
    maxCompetitors: 200,
    wcaDelegate: "Carlos Andrés Rodríguez",
    status: "coming-soon",
  },
  {
    name: "Pereira Open 2025",
    date: "2025-08-16",
    city: "Pereira",
    location: "Pereira, Colombia",
    venue: "Universidad Tecnológica de Pereira",
    events: ["3x3x3", "2x2x2", "4x4x4", "Pyraminx", "Skewb"],
    registrationDeadline: "2025-08-11",
    maxCompetitors: 85,
    wcaDelegate: "Camilo Vargas",
    status: "coming-soon",
  },
  {
    name: "Manizales Cubing 2025",
    date: "2025-09-13",
    city: "Manizales",
    location: "Manizales, Colombia",
    venue: "Universidad Nacional de Colombia - Sede Manizales",
    events: ["3x3x3", "2x2x2", "4x4x4", "5x5x5", "3x3x3 OH"],
    registrationDeadline: "2025-09-08",
    maxCompetitors: 70,
    wcaDelegate: "Laura Gómez",
    status: "coming-soon",
  },
];

// Client-side state management
const ITEMS_PER_PAGE = 6;
let currentPage = 1;
let selectedCity = "todas";

// Get unique cities for filter
const cities = ["todas", ...new Set(allEvents.map((event) => event.city))];

// Filter and pagination functions
function getFilteredEvents() {
  if (selectedCity === "todas") {
    return allEvents;
  }
  return allEvents.filter((event) => event.city === selectedCity);
}

function getPaginatedEvents() {
  const filteredEvents = getFilteredEvents();
  const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
  const endIndex = startIndex + ITEMS_PER_PAGE;
  return filteredEvents.slice(startIndex, endIndex);
}

function getTotalPages() {
  const filteredEvents = getFilteredEvents();
  return Math.ceil(filteredEvents.length / ITEMS_PER_PAGE);
}

// Initial display events
const upcomingEvents = getPaginatedEvents();

function formatDate(dateString: string): string {
  const date = new Date(dateString);
  return date.toLocaleDateString("es-CO", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
}

function getStatusColor(status: string): string {
  switch (status) {
    case "registration-open":
      return "bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300";
    case "coming-soon":
      return "bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300";
    case "full":
      return "bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-300";
    default:
      return "bg-gray-100 dark:bg-gray-900 text-gray-600 dark:text-gray-300";
  }
}

function getStatusText(status: string): string {
  switch (status) {
    case "registration-open":
      return "Inscripciones Abiertas";
    case "coming-soon":
      return "Inscripciones Próximamente";
    case "full":
      return "Cupos Agotados";
    default:
      return "Por Confirmar";
  }
}
---

<section id="upcoming-events" class="section">
  <div class="container-custom">
    <div class="text-center max-w-3xl mx-auto mb-16">
      <span
        class="inline-block px-4 py-1 rounded-full bg-secondary-100 dark:bg-secondary-900 text-secondary-600 dark:text-secondary-300 font-medium text-sm mb-4"
      >
        Speedcubing Colombia
      </span>
      <h2 class="mb-6 text-gray-900 dark:text-white">
        Calendario Oficial de Competencias WCA
      </h2>
      <p class="text-gray-600 dark:text-gray-300">
        Explora el calendario oficial de competencias de speedcubing organizadas
        por Speedcubing Colombia, la organización líder en el desarrollo del
        cubo de Rubik competitivo en el país, certificadas por la World Cube
        Association (WCA).
      </p>
    </div>

    <!-- Filter and Pagination Controls -->
    <div
      class="mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"
    >
      <!-- City Filter -->
      <div class="flex items-center gap-3">
        <label
          for="city-filter"
          class="text-sm font-medium text-gray-700 dark:text-gray-300"
        >
          Buscar por ciudad:
        </label>
        <select
          id="city-filter"
          class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent"
          onchange="filterByCity(this.value)"
        >
          {
            cities.map((city) => (
              <option value={city} selected={city === selectedCity}>
                {city === "todas" ? "Todas las ciudades" : city}
              </option>
            ))
          }
        </select>
      </div>

      <!-- Results Info -->
      <div class="text-sm text-gray-500 dark:text-gray-400" id="results-info">
        Mostrando {upcomingEvents.length} de {getFilteredEvents().length} eventos
        programados
      </div>
    </div>

    <!-- Events Grid -->
    <div class="grid md:grid-cols-3 gap-8" id="events-grid">
      {
        upcomingEvents.map((event, index) => (
          <div
            class="card p-6 border border-gray-200 dark:border-gray-700 slide-up relative"
            style={`animation-delay: ${index * 150}ms`}
          >
            <div class="absolute top-4 right-4">
              <span
                class={`px-3 py-1 rounded-full text-xs font-medium ${getStatusColor(event.status)}`}
              >
                {getStatusText(event.status)}
              </span>
            </div>

            <div class="mb-6">
              <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">
                {event.name}
              </h3>
              <p class="text-primary-600 dark:text-primary-400 font-medium">
                {formatDate(event.date)}
              </p>
              <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                {event.location}
              </p>
            </div>

            <div class="mb-6 space-y-3">
              <div class="flex items-start">
                <svg
                  class="w-4 h-4 text-gray-400 mt-1 mr-2 flex-shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                  />
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                  />
                </svg>
                <p class="text-sm text-gray-600 dark:text-gray-300">
                  {event.venue}
                </p>
              </div>

              <div class="flex items-start">
                <svg
                  class="w-4 h-4 text-gray-400 mt-1 mr-2 flex-shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                  />
                </svg>
                <p class="text-sm text-gray-600 dark:text-gray-300">
                  Delegado: {event.wcaDelegate}
                </p>
              </div>

              <div class="flex items-start">
                <svg
                  class="w-4 h-4 text-gray-400 mt-1 mr-2 flex-shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
                  />
                </svg>
                <p class="text-sm text-gray-600 dark:text-gray-300">
                  Límite: {event.maxCompetitors} competidores
                </p>
              </div>
            </div>

            <div class="mb-6">
              <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">
                Categorías:
              </p>
              <div class="flex flex-wrap gap-1">
                {event.events.map((eventType) => (
                  <span class="px-2 py-1 bg-gray-100 dark:bg-gray-700 text-xs text-gray-700 dark:text-gray-300 rounded">
                    {eventType}
                  </span>
                ))}
              </div>
            </div>

            <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
              <p class="text-xs text-gray-500 dark:text-gray-400 mb-3">
                Fecha límite de inscripción:{" "}
                {formatDate(event.registrationDeadline)}
              </p>
              <a
                href="#register"
                class="w-full inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium text-sm transition-all duration-300 focus:outline-hidden focus:ring-2 focus:ring-offset-2 bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"
                class:list={[
                  event.status === "full" && "opacity-50 cursor-not-allowed",
                  event.status === "coming-soon" &&
                    "opacity-75 cursor-not-allowed",
                ]}
              >
                {event.status === "registration-open" && (
                  <>
                    Registrarse Ahora
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-4 w-4 ml-2"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </>
                )}
                {event.status === "coming-soon" && "Inscripciones Próximamente"}
                {event.status === "full" && "Cupos Agotados"}
              </a>
            </div>
          </div>
        ))
      }
    </div>

    <!-- Pagination Controls -->
    <div
      class="mt-12 flex justify-center items-center gap-2"
      id="pagination-controls"
    >
      <button
        onclick="changePage(currentPage - 1)"
        class="px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
        disabled={currentPage <= 1}
        class:list={[currentPage <= 1 && "opacity-50 cursor-not-allowed"]}
      >
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"></path>
        </svg>
      </button>

      {
        Array.from({ length: getTotalPages() }, (_, i) => i + 1).map(
          (pageNum) => (
            <button
              onclick={`changePage(${pageNum})`}
              class={`px-3 py-2 rounded-lg transition-colors ${
                pageNum === currentPage
                  ? "bg-primary-600 text-white"
                  : "border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
              }`}
            >
              {pageNum}
            </button>
          )
        )
      }

      <button
        onclick="changePage(currentPage + 1)"
        class="px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
        disabled={currentPage >= getTotalPages()}
        class:list={[
          currentPage >= getTotalPages() && "opacity-50 cursor-not-allowed",
        ]}
      >
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"></path>
        </svg>
      </button>
    </div>

    <div
      class="mt-16 bg-linear-to-r from-primary-500 to-secondary-500 rounded-2xl p-8 md:p-12 relative overflow-hidden"
    >
      <div
        class="absolute inset-0 bg-linear-to-r from-primary-600/30 to-secondary-600/30 backdrop-blur-xs"
      >
      </div>
      <div
        class="relative z-10 text-center md:text-left md:flex items-center justify-between"
      >
        <div class="mb-6 md:mb-0 md:mr-8">
          <h3 class="text-2xl md:text-3xl font-bold text-white mb-4">
            ¿Quieres ser parte de Speedcubing Colombia?
          </h3>
          <p class="text-white/80 max-w-2xl">
            Únete a la organización oficial de speedcubing en Colombia.
            Conviértete en delegado WCA, organiza competencias oficiales, o
            apoya el crecimiento del deporte del cubo de Rubik en todo el
            territorio nacional.
          </p>
        </div>
        <a
          href="#unirse"
          class="inline-flex items-center justify-center px-6 py-3 rounded-lg font-medium transition-all duration-300 focus:outline-hidden focus:ring-2 focus:ring-offset-2 bg-white text-primary-600 hover:bg-gray-100 focus:ring-white"
        >
          Únete a Nosotros
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 ml-2"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              fill-rule="evenodd"
              d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z"
              clip-rule="evenodd"></path>
          </svg>
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  // Global variables for client-side state
  let currentPage = 1;
  let selectedCity = "todas";

  const allEvents = [
    {
      name: "Bogotá Open 2025",
      date: "2025-01-15",
      city: "Bogotá",
      location: "Bogotá, Colombia",
      venue: "Universidad Nacional de Colombia",
      events: ["3x3x3", "2x2x2", "4x4x4", "5x5x5", "3x3x3 OH", "Pyraminx"],
      registrationDeadline: "2025-01-10",
      maxCompetitors: 150,
      wcaDelegate: "Carlos Andrés Rodríguez",
      status: "registration-open",
    },
    {
      name: "Medellín Speed Championship 2025",
      date: "2025-02-08",
      city: "Medellín",
      location: "Medellín, Colombia",
      venue: "Centro de Convenciones Plaza Mayor",
      events: ["3x3x3", "2x2x2", "4x4x4", "3x3x3 BLD", "Skewb", "Clock"],
      registrationDeadline: "2025-02-03",
      maxCompetitors: 120,
      wcaDelegate: "María Elena Vargas",
      status: "registration-open",
    },
    {
      name: "Cali Cube Fest 2025",
      date: "2025-03-22",
      city: "Cali",
      location: "Cali, Colombia",
      venue: "Universidad ICESI",
      events: [
        "3x3x3",
        "2x2x2",
        "4x4x4",
        "5x5x5",
        "6x6x6",
        "7x7x7",
        "Megaminx",
      ],
      registrationDeadline: "2025-03-17",
      maxCompetitors: 100,
      wcaDelegate: "Andrés Felipe García",
      status: "coming-soon",
    },
    {
      name: "Cartagena Beach Cubing 2025",
      date: "2025-04-12",
      city: "Cartagena",
      location: "Cartagena, Colombia",
      venue: "Centro de Convenciones Cartagena de Indias",
      events: ["3x3x3", "2x2x2", "Pyraminx", "Skewb"],
      registrationDeadline: "2025-04-07",
      maxCompetitors: 80,
      wcaDelegate: "Isabella Martínez",
      status: "coming-soon",
    },
    {
      name: "Bucaramanga Open 2025",
      date: "2025-05-10",
      city: "Bucaramanga",
      location: "Bucaramanga, Colombia",
      venue: "Universidad Industrial de Santander",
      events: ["3x3x3", "2x2x2", "4x4x4", "3x3x3 OH", "Clock"],
      registrationDeadline: "2025-05-05",
      maxCompetitors: 90,
      wcaDelegate: "Diego Ramírez",
      status: "coming-soon",
    },
    {
      name: "Barranquilla Speed Day 2025",
      date: "2025-06-14",
      city: "Barranquilla",
      location: "Barranquilla, Colombia",
      venue: "Universidad del Norte",
      events: ["3x3x3", "2x2x2", "4x4x4", "Pyraminx"],
      registrationDeadline: "2025-06-09",
      maxCompetitors: 75,
      wcaDelegate: "Ana Sofía López",
      status: "coming-soon",
    },
    {
      name: "Bogotá Championship 2025",
      date: "2025-07-20",
      city: "Bogotá",
      location: "Bogotá, Colombia",
      venue: "Centro de Convenciones Gonzalo Jiménez de Quesada",
      events: [
        "3x3x3",
        "2x2x2",
        "4x4x4",
        "5x5x5",
        "6x6x6",
        "7x7x7",
        "3x3x3 BLD",
        "3x3x3 OH",
        "Megaminx",
        "Pyraminx",
        "Skewb",
        "Square-1",
        "Clock",
      ],
      registrationDeadline: "2025-07-15",
      maxCompetitors: 200,
      wcaDelegate: "Carlos Andrés Rodríguez",
      status: "coming-soon",
    },
    {
      name: "Pereira Open 2025",
      date: "2025-08-16",
      city: "Pereira",
      location: "Pereira, Colombia",
      venue: "Universidad Tecnológica de Pereira",
      events: ["3x3x3", "2x2x2", "4x4x4", "Pyraminx", "Skewb"],
      registrationDeadline: "2025-08-11",
      maxCompetitors: 85,
      wcaDelegate: "Camilo Vargas",
      status: "coming-soon",
    },
    {
      name: "Manizales Cubing 2025",
      date: "2025-09-13",
      city: "Manizales",
      location: "Manizales, Colombia",
      venue: "Universidad Nacional de Colombia - Sede Manizales",
      events: ["3x3x3", "2x2x2", "4x4x4", "5x5x5", "3x3x3 OH"],
      registrationDeadline: "2025-09-08",
      maxCompetitors: 70,
      wcaDelegate: "Laura Gómez",
      status: "coming-soon",
    },
  ];

  const ITEMS_PER_PAGE = 6;

  function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString("es-CO", {
      year: "numeric",
      month: "long",
      day: "numeric",
    });
  }

  function getStatusColor(status) {
    switch (status) {
      case "registration-open":
        return "bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300";
      case "coming-soon":
        return "bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300";
      case "full":
        return "bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-300";
      default:
        return "bg-gray-100 dark:bg-gray-900 text-gray-600 dark:text-gray-300";
    }
  }

  function getStatusText(status) {
    switch (status) {
      case "registration-open":
        return "Inscripciones Abiertas";
      case "coming-soon":
        return "Inscripciones Próximamente";
      case "full":
        return "Cupos Agotados";
      default:
        return "Por Confirmar";
    }
  }

  function getFilteredEvents() {
    if (selectedCity === "todas") {
      return allEvents;
    }
    return allEvents.filter((event) => event.city === selectedCity);
  }

  function getPaginatedEvents() {
    const filteredEvents = getFilteredEvents();
    const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
    const endIndex = startIndex + ITEMS_PER_PAGE;
    return filteredEvents.slice(startIndex, endIndex);
  }

  function getTotalPages() {
    const filteredEvents = getFilteredEvents();
    return Math.ceil(filteredEvents.length / ITEMS_PER_PAGE);
  }

  function renderEventCard(event, index) {
    return `
      <div
        class="card p-6 border border-gray-200 dark:border-gray-700 slide-up relative"
        style="animation-delay: ${index * 150}ms"
      >
        <div class="absolute top-4 right-4">
          <span class="px-3 py-1 rounded-full text-xs font-medium ${getStatusColor(event.status)}">
            ${getStatusText(event.status)}
          </span>
        </div>

        <div class="mb-6">
          <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">
            ${event.name}
          </h3>
          <p class="text-primary-600 dark:text-primary-400 font-medium">
            ${formatDate(event.date)}
          </p>
          <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
            ${event.location}
          </p>
        </div>

        <div class="mb-6 space-y-3">
          <div class="flex items-start">
            <svg class="w-4 h-4 text-gray-400 mt-1 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
            </svg>
            <p class="text-sm text-gray-600 dark:text-gray-300">
              ${event.venue}
            </p>
          </div>

          <div class="flex items-start">
            <svg class="w-4 h-4 text-gray-400 mt-1 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
            <p class="text-sm text-gray-600 dark:text-gray-300">
              Delegado: ${event.wcaDelegate}
            </p>
          </div>

          <div class="flex items-start">
            <svg class="w-4 h-4 text-gray-400 mt-1 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
            </svg>
            <p class="text-sm text-gray-600 dark:text-gray-300">
              Límite: ${event.maxCompetitors} competidores
            </p>
          </div>
        </div>

        <div class="mb-6">
          <p class="text-sm text-gray-500 dark:text-gray-400 mb-2">
            Categorías:
          </p>
          <div class="flex flex-wrap gap-1">
            ${event.events
              .map(
                (eventType) =>
                  `<span class="px-2 py-1 bg-gray-100 dark:bg-gray-700 text-xs text-gray-700 dark:text-gray-300 rounded">
                ${eventType}
              </span>`
              )
              .join("")}
          </div>
        </div>

        <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
          <p class="text-xs text-gray-500 dark:text-gray-400 mb-3">
            Fecha límite de inscripción: ${formatDate(event.registrationDeadline)}
          </p>
          <a
            href="#register"
            class="w-full inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium text-sm transition-all duration-300 focus:outline-hidden focus:ring-2 focus:ring-offset-2 bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500 ${
              event.status === "full" || event.status === "coming-soon"
                ? "opacity-75 cursor-not-allowed"
                : ""
            }"
          >
            ${
              event.status === "registration-open"
                ? `Registrarse Ahora
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
              </svg>`
                : event.status === "coming-soon"
                  ? "Inscripciones Próximamente"
                  : "Cupos Agotados"
            }
          </a>
        </div>
      </div>
    `;
  }

  function updateDisplay() {
    const events = getPaginatedEvents();
    const totalFiltered = getFilteredEvents().length;
    const totalPages = getTotalPages();

    // Update events grid
    const eventsGrid = document.getElementById("events-grid");
    eventsGrid.innerHTML = events.map(renderEventCard).join("");

    // Update results info
    const resultsInfo = document.getElementById("results-info");
    resultsInfo.textContent = `Mostrando ${events.length} de ${totalFiltered} eventos programados`;

    // Update pagination controls
    updatePaginationControls(totalPages);
  }

  function updatePaginationControls(totalPages) {
    const paginationContainer = document.getElementById("pagination-controls");

    if (totalPages <= 1) {
      paginationContainer.style.display = "none";
      return;
    }

    paginationContainer.style.display = "flex";

    let paginationHTML = `
      <button 
        onclick="changePage(${currentPage - 1})"
        class="px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${
          currentPage <= 1 ? "opacity-50 cursor-not-allowed" : ""
        }"
        ${currentPage <= 1 ? "disabled" : ""}
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </button>
    `;

    for (let i = 1; i <= totalPages; i++) {
      paginationHTML += `
        <button 
          onclick="changePage(${i})"
          class="px-3 py-2 rounded-lg transition-colors ${
            i === currentPage
              ? "bg-primary-600 text-white"
              : "border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"
          }"
        >
          ${i}
        </button>
      `;
    }

    paginationHTML += `
      <button 
        onclick="changePage(${currentPage + 1})"
        class="px-3 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${
          currentPage >= totalPages ? "opacity-50 cursor-not-allowed" : ""
        }"
        ${currentPage >= totalPages ? "disabled" : ""}
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
    `;

    paginationContainer.innerHTML = paginationHTML;
  }

  function filterByCity(city) {
    selectedCity = city;
    currentPage = 1; // Reset to first page when filtering
    updateDisplay();
  }

  function changePage(newPage) {
    const totalPages = getTotalPages();
    if (newPage >= 1 && newPage <= totalPages) {
      currentPage = newPage;
      updateDisplay();

      // Scroll to top of events section
      document.getElementById("upcoming-events").scrollIntoView({
        behavior: "smooth",
        block: "start",
      });
    }
  }

  // Initialize display when page loads
  document.addEventListener("DOMContentLoaded", function () {
    updateDisplay();
  });
</script>
