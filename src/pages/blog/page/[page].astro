---
import BlogListPage from "../../../components/BlogListPage.astro";
import { getBlogPosts, POSTS_PER_PAGE } from "../../../utils/blog";

export async function getStaticPaths() {
  const posts = await getBlogPosts();
  const totalPages = Math.max(1, Math.ceil(posts.length / POSTS_PER_PAGE));

  return Array.from({ length: totalPages }, (_, index) => {
    const currentPage = index + 1;
    return {
      params: { page: currentPage.toString() },
      props: {
        pagination: {
          current: currentPage,
          total: totalPages,
        },
        paginatedPosts: posts.slice(
          index * POSTS_PER_PAGE,
          index * POSTS_PER_PAGE + POSTS_PER_PAGE
        ),
      },
    };
  });
}

const { pagination, paginatedPosts } = Astro.props;
---

<BlogListPage posts={paginatedPosts} pagination={pagination} />
